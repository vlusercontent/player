!function(){"use strict";var e,t,i="googima",s="TYPE_API",n="TYPE_SCHEDULE",r="jw-flag-ads-googleima",a="jw-flag-ads-vpaid",o="jw-flag-ads-vpaid-controls",l="playing",d="adError",u="adItem",h="adStarted",c="viewable",p="external",g=p,m="instream",f="article",v=((e={})[[m]]=1,e[["banner"]]=2,e[[f]]=3,e[["feed"]]=4,e[["floating"]]=5,e[["interstitial"]]=5,e[["slider"]]=5,e);function y(){return y=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s])}return e},y.apply(this,arguments)}var A="vast",P="googima",w="vmap",b="-1",k="cust_params=",E="adBreakIgnored",M="adError",C="__jwpseg__",_="instream",I="article",R=((t={})[[_]]=1,t[["banner"]]=2,t[[I]]=3,t[["feed"]]=4,t[["floating"]]=5,t[["interstitial"]]=5,t[["slider"]]=5,t),S=function(e,t,i,s){if(0!==s.indexOf(e))return!1;var n=parseFloat(s.slice(e.length));return!(n<t||n>i)&&n},L=S.bind(null,"800000",10,90),T=S.bind(null,"900000",10,90),j=S.bind(null,"JWIAB",1,999),x=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)};function B(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(i)return(i=i.call(e)).next.bind(i);if(Array.isArray(e)||(i=function(e,t){if(!e)return;if("string"==typeof e)return D(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);"Object"===i&&e.constructor&&(i=e.constructor.name);if("Map"===i||"Set"===i)return Array.from(e);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return D(e,t)}(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var s=0;return function(){return s>=e.length?{done:!0}:{done:!1,value:e[s++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function D(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,s=new Array(t);i<t;i++)s[i]=e[i];return s}var O=/^[^/]*:\/\/\/?([^/]*)/,q=function(e){var t=e.match(O);return t&&t.length>1?t[1]:""},U=/^[^:/?#]+:?\/\/[^/?#]+/,V=/^(https?:\/\/).*.(?:ampproject.org|bing-amp.com)\/(?:.\/)*(.*)\/amp.*$/,N=function(e){var t=new RegExp("[?&]"+e+"=([^&]*)"),i=document.location.search.match(t);if(i)return decodeURIComponent(i[1])},H=Date.now||function(){return(new Date).getTime()},z=function(e){var t=function(e){for(var t=window;t;){try{if(t.frames[e])break}catch(e){}t=t===window.top?null:t.parent}return t}(e+"Locator");return null!==t&&function(i,s,n,r){var a,o,l=H();window.addEventListener("message",(function t(i){var s=i?i.data:{};if("string"==typeof s)try{s=JSON.parse(s)}catch(e){s={}}var r=e+"Return";s[r]&&s[r].callId===l&&(removeEventListener("message",t),n(s[r].returnValue,s[r].success))}),!1);var d=((o={})[[e+"Call"]]=((a={command:i,callId:l,parameter:r})[[void 0!==r?"version":"parameter"]]=s,a),o);t.postMessage(JSON.stringify(d),"*")}},Q=null,W={gdprApplies:!0,consentData:""},G=function(e){return void 0===e&&(e=1e3),null===Q&&(Q=new Promise((function(e){var t=window.__tcfapi||z("__tcfapi");if(t)return t("getTCData",2,(function(t,i){e(!1!==i?{gdprApplies:t.gdprApplies,consentData:t.tcString,addtlConsent:t.addtlConsent}:null)}));var i=window.__cmp||z("__cmp");if(i)return i("getConsentData",null,(function(t,i){e(!1!==i?{gdprApplies:t.gdprApplies||t.isUserInEu,consentData:t.consentData}:null)}));var s=function(){if(N("isAMP")){var e=N("consentValue"),t=N("consentGdpr");if(e||t)return{gdprApplies:t,consentData:e}}}();return e(s||{gdprApplies:!1,consentData:""})})).then((function(e){return e&&(W=e),W}))),Promise.race([Q,new Promise((function(t){setTimeout(t,e,W)}))])},J=function(e){var t=e.advertising;if(t&&t.placement){var i=t.placement.toLowerCase();if(R[i])return R[i]}return R[t&&t.outstream?I:_]},X=function(){var e,t,i=null!==document.referrer.match(U)?(e=document.referrer,(t=e.match(V))&&t.length>1?""+t[1]+t[2]:e):"";if(window.top!==window.self){try{return{url:window.top.location.href,domain:window.top.document.domain,referrer:i}}catch(e){}return{url:i,domain:q(i),referrer:""}}return{url:document.location.href,domain:document.domain,referrer:i}},F=function(e,t){var i,s=e.getPlugin("inference"),n=t.jwpseg_client_side,r=t.jwpseg||[];if(!n||!n.length||!s)return r;try{i=s.predict(n,t)}catch(e){return t.jwpseg||[]}var a=Object.keys(i).filter((function(e){return i[e]})),o=r.filter((function(e){return-1===n.indexOf(e)}));return[].concat(a,o)},$=function(e,t,i){var s=F(e,t);if(!s.length)return i;var n=function(e){for(var t,i=[],s=[],n=[],r=[],a=B(e);!(t=a()).done;){var o=t.value,l=L(o);if(l)i.push(l);else{var d=T(o);if(d)s.push(d);else{var u=j(o);u?n.push(u):"JWBRSAFE"===o&&r.push(1)}}}return i.length||s.length||n.length||r.length?{hb_jwvb:i,hb_jwcr:s,hb_jwiab:n,hb_jwbs:r}:null}(s);if(!n)return i;var r=i.split("?"),a=r[0],o=r[1],l=function(e){var t=[];for(var i in e)x(e,i)&&e[i].length&&t.push(i+"="+e[i]);return t.join("&")}(n);if(!o)return a+"?cust_params="+encodeURIComponent(l);for(var d=o.split("&"),u=0;u<d.length;u++)if(0===d[u].indexOf("cust_params"))return 11===d[u].length?d[u]+="="+encodeURIComponent(l):12===d[u].length?d[u]+=encodeURIComponent(l):d[u]+=encodeURIComponent("&"+l),a+"?"+d.join("&");return i+"&cust_params="+encodeURIComponent(l)},K=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)},Y=/^((https?:)?\/\/)?(secure)?pubads\.g\.doubleclick\.net\/gampad\/ads\?[\S]*$/,Z=function(e,t,i){return e.replace(t,i)},ee=function(e,t,i,s,n,r){if(void 0===r&&(r={}),!e)return Promise.resolve(e);var a=function(e,t){var i,s,n,r=e.getConfig(),a=e.getPlaylistItem()===t;return y({playerHeight:e.getHeight()||r.height||"",playerWidth:e.getWidth()||r.width||"",itemDuration:a?(i=e.getDuration(),s=3,n=Math.pow(10,s),Math.round(i*n)/n||""):"",item:t,jwpseg:F(e,t),placement:J(r),userAgent:navigator.userAgent},r.advertising?r.advertising.ampMacros:{})}(t,i),o=X();-1!==e.indexOf(C)&&(r.jwpseg=a.jwpseg),e=Z(e,"__random-number__",Math.random()*Math.pow(10,18)),e=Z(e,"__timestamp__",(new Date).getTime()),e=Z(e,"__page-url__",encodeURIComponent(a.pageUrl||o.url)),e=Z(e,"__referrer__",encodeURIComponent(a.referrer||o.referrer)),e=Z(e,"__player-height__",a.playerHeight),e=Z(e,"__player-width__",a.playerWidth),e=Z(e,"__item-duration__",a.itemDuration),e=Z(e,C,a.jwpseg),e=Z(e,"__domain__",encodeURIComponent(a.domain||o.domain)),e=Z(e,"__placement__",a.placement),e=Z(e,"__device-ua__",encodeURIComponent(a.userAgent)),e=n.companion?Z(e,"__companion-div__",n.companion.id):Z(e,"__companion-div__","");for(var l=Object.keys(a).filter((function(e){return-1!==e.indexOf("item")})),d=l.map((function(e){var t,i=e.match(/item([\w]+?)(List)?$/);return i&&(t=i[1].toLowerCase()),t})),u=null,h=/__item-([\w-]+?)(-list)?__/g,c=e;null!==(u=h.exec(c));){var p=u[0],g=u[1],m=l[d.indexOf(g)],f="";if(K(i,g)&&"string"==typeof i[g]||m){f=m?a[m]:i[g];var v=!1===n.truncateMacros?4096:1e3;f.length>v&&(f=f.substring(0,v));var w=u[2]?",":null;f=f.split(w).map(encodeURIComponent)}e=Z(e,p,f)}if(s===A){var b=t.getConfig().autostart?1:0,k=t.getMute()?1:0;e=function(e,t,i){return Y.test(e)&&(e=e+"&vpa="+t+"&vpmute="+i),e}(e,b,k)}if(s===P&&i.title&&-1===e.indexOf("vid_t=")){var E=i.title.substring(0,100).replace(/[^\x00-\x7F]/g,"");e+=function(e){return-1!==e.indexOf("?")?"&":"?"}(e)+"vid_t="+encodeURIComponent(E)}return-1!==e.indexOf("__gdpr__")||-1!==e.indexOf("__gdpr_consent__")||-1!==e.indexOf("__addtl_consent__")?G().then((function(t){var i=t.gdprApplies,s=t.consentData,n=t.addtlConsent;return e=Z(e,"__gdpr__",i?1:0),e=Z(e,"__addtl_consent__",n||""),Z(e,"__gdpr_consent__",s||"")})).catch((function(){return e})):Promise.resolve(e)},te=function(){},ie=function(e,t,i){var s=[];return e&&(s=e.getElementsByTagName(t),i&&s&&0===s.length&&(s=e.getElementsByTagName(i+":"+t))),s},se=function(e,t){return e?e.getAttribute(t):null},ne=function(e,t,i){e.push({message:t,code:1002,adErrorCode:70001,id:i})},re=function(){var e=new Error("No AdBreaks in VMAP");throw e.adErrorCode=60005,e},ae=function(e){if(e){var t=e.textContent||e.text;if(t)return t.trim()}return""},oe=function(e,t){if(e){var i=e.getElementsByTagName(t);if(i)return i[0]}return null},le=function(e){(e.indexOf("[REGULATIONS]")>=0||e.indexOf("[GDPRCONSENT]")>=0)&&(G().catch(te),le=te)},de=function(e,t){var i=se(t,"event");"progress"===i&&(i=i+"_"+se(t,"offset"));!function(e,t,i){e[t]||(e[t]=[]),i&&(e[t].push(i),le(i))}(e,i,ae(t))},ue=function(e,t){if(!e)return null;var i=e.getElementsByTagName("Ad");if(!i.length)return null;var s={_offSet:t};if(1===i.length)s._adQueue=[i[0].textContent.trim()];else{s._pod=[];for(var n=0;n<i.length;n++)s._pod.push(i[n].textContent.trim())}return s},he=function(e,t,i){if(ie(e,"VMAP",w).length)return function(e,t,i){var s=[],n=ie(e,"VMAP",w);se(n[0],"version")||ne(s,"VMAP Schema Error: version missing from VMAP tag",b);var r=ie(e,"AdBreak",w);r.length||re();for(var a,o,l,d,u,h,c=e.lookupNamespaceURI(w),p={},g=0;g<r.length;g++){var m={},f={},v=r[g],y=se(v,"timeOffset"),A=se(v,"breakId"),P=se(v,"breakType"),k=ie(v,"AdSource",w)[0],E=se(k,"id"),M=ie(v,"AdTagURI",w)[0],C=ie(v,"VASTData",w)[0]||ie(v,"VASTAdData",w)[0],_=se(M,"templateType"),I=ae(M),R=(l=v,d="Tracking",u=w,h=void 0,h=[],(o=c)||l?h=l.getElementsByTagNameNS?l.getElementsByTagNameNS(o,d):l.getElementsByTagName(u+":"+d):h);if(P||ne(s,"VMAP Schema Error: missing breakType on AdBreak",A),C||_||ne(s,"VMAP Schema Error: missing templateType on AdBreak",A),y||ne(s,"VMAP Schema Error: missing timeOffset on AdBreak",A),m._type=P,m._vmap={id:E,breakid:A,timeoffset:y},C)m._adXML=(a=oe(C,"VAST")).ownerDocument instanceof Document?a.outerHTML||(new XMLSerializer).serializeToString(a):null;else{if("vast2"!==_&&"vast3"!==_&&"vast4"!==_)continue;m._adQueue=[I],m._waterfallIndex=0}var S=[];if(R)for(var L=0;L<R.length;L++){de(f,R[L]);var T=se(R[L],"event");S.push(T)}if((S.indexOf("breakStart")<0||S.indexOf("breakEnd")<0||S.indexOf("error")<0)&&ne(s,"Tracking events are missing breakStart, breakEnd, or error for AdBreak",A),m._trackers=f,m._type=P,y&&!p[y])p[y]=m,p[y]._pod=m._adQueue?[].concat(m._adQueue):[];else if(y&&p[y]){var j;m._adQueue&&(j=p[y]._pod).push.apply(j,m._adQueue)}}return Object.keys(p).forEach((function(e){var s=p[e];switch(s._pod&&s._pod.length<=1&&delete s._pod,e){case"start":s._offSet="pre",t.setPreRoll(s);break;case"100%":case"end":s._offSet="post",t.setPostRoll(s);break;default:if(/^#/.test(e))break;/^\d\d?(?:\.\d+)?%$/.test(e)?s._offSet=e:s._offSet=i.seconds(e),t.addMidRoll(s)}})),t.preRoll||t.midRolls.length||t.postRoll||re(),t.sort(null,!0),s}(e,t,i);if(ie(e,"Playlist",w).length)return function(e,t,i){var s=ie(e,"Playlist",w)[0],n=s.getElementsByTagName("Preroll")[0],r=s.getElementsByTagName("Postroll")[0],a=ue(n,"pre"),o=ue(r,"post");a&&t.setPreRoll(a),o&&t.setPostRoll(o);for(var l=s.getElementsByTagName("Midroll"),d=0;d<l.length;d++){var u=l[d],h=i.seconds(u.getAttribute("timeOffset")),c=ue(u,h);t.addMidRoll(c)}return[]}(e,t,i);throw new Error("No VMAP tag in response")},ce=function(e){e.onload=e.onreadystatechange=e.onerror=null,"abort"in e&&e.abort()},pe=function(e,t,i){var s;if(null!==e)return Object.keys(e).forEach((function(t){var i=e[t];(s=s||{})[t]="_adQueue"===t||"_pod"===t?i.slice():i})),s?(s.requestTimeout=t,s.creativeTimeout=i,s._errors=[],s._waterfallIndex=0,s._adPodIndex=0,s):void 0},ge=function(e,t){return"%"===e.toString().slice(-1)?t*parseFloat(e.slice(0,-1))/100:parseFloat(e)},me=function(){function e(e,t){this.adRules=e,this.utils=t,this.preRoll=null,this.vmap=null,this.postRoll=null,this.midRolls=[],this.playedMidRolls=[],this.duration=0,this._vmapPromise=null,this._vmapXHR=null}var t=e.prototype;return t.load=function(e,t,i,s){var n=this;if(this._vmapPromise)return this._vmapPromise;null!==this._vmapXHR&&(ce(this._vmapXHR),this._vmapXHR=null);var r=ee(this.getVMAP(),e,t,i,s);return i===P?(this._vmapPromise=r.then((function(e){n.setPreRoll({_adQueue:[e]})})),this._vmapPromise):(this._vmapPromise=r.then((function(t){return new Promise((function(i,r){n._vmapXHR=e.utils.ajax({url:t,withCredentials:s.withCredentials,retryWithoutCredentials:!0,requireValidXML:!0,timeout:n.requestTimeout},i,(function(e,t,i,s){return r(s)}))})).then((function(s){return n._vmapXHR=null,e.trigger("adLoadedXML",{client:i,tag:t,xml:s.responseXML}),he(s.responseXML,n,e.utils).map((function(e){return y(e,{vmap:t})}))})).catch((function(i){n._vmapXHR=null;var s={id:b,vmap:t};if(i.message)y(s,{message:"VMAP Schema Error: "+i.message,code:1002,adErrorCode:i.adErrorCode||11002});else{var r={1:{code:1007,message:"Timeout"},602:{code:1e3,message:"Invalid XML"},default:{code:1008,message:e.getConfig().localization.errors[i.key]}},a=r[i.code]||r.default;e.utils.log(a.message),y(s,{message:"Error Loading VMAP Schedule",code:a.code,adErrorCode:a.code+1e4})}throw s}))})),this._vmapPromise)},t.canWaterfall=function(e){return e._adQueue&&e._waterfallIndex+1<e._adQueue.length},t.getPreRoll=function(e){return e&&"none"===this.adRules.startOnSeek?null:pe(this.preRoll,this.requestTimeout,this.creativeTimeout)},t.getPostRoll=function(e){var t=pe(this.postRoll,this.requestTimeout,this.creativeTimeout);return this.adRules.timeBetweenAdsAllowsAdPlayback(t,e)?t:null},t.getMidRollAtIndex=function(e){var t=this.midRolls[e];return pe(t,this.requestTimeout,this.creativeTimeout)},t.getLastMidRollIndexBetweenTime=function(e,t,i){if(e>t)return null;this.sort(i);for(var s=this.midRolls.length;s--;){var n=this.midRolls[s],r=ge(this.midRolls[s]._offSet,i);if(e>=r)return null;if(t>=r){var a=pe(n,this.requestTimeout,this.creativeTimeout);if(!this.adRules.timeBetweenAdsAllowsAdPlayback(a))return null;if(!this.adRules.timeBetweenAds){if(this.playedMidRolls.indexOf(s)>=0)return null;this.playedMidRolls.push(s)}return s}}return null},t.peek=function(e,t,i){if(this.midRolls.length>this.playedMidRolls.length){this.sort(i);for(var s=0;this.midRolls[s];){var n=this.midRolls[s],r=ge(n._offSet,i);if(r>=e&&-1===this.playedMidRolls.indexOf(s)){var a=H()+1e3*(r-e);return r<=t&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,a)?s:null}s+=1}}var o=H()+1e3*(i-e);return this.postRoll&&t>=i&&this.adRules.timeBetweenAdsAllowsAdPlayback(null,o)?-1:null},t.getNextMidrollIndex=function(e,t,i){if(this.adRules.timeBetweenAds||this.adRules.startOnSeek)return this.getLastMidRollIndexBetweenTime(e,t,i);if(this.midRolls.length>this.playedMidRolls.length){var s=this.getClosestIndex(t,i);if(s>=0&&this.playedMidRolls.indexOf(s)<0)return this.playedMidRolls.push(s),s}return null},t.getMidRolls=function(){var e=this;return this.midRolls.map((function(t){return pe(t,e.requestTimeout,e.creativeTimeout)}))},t.reset=function(){null!==this._vmapXHR&&(ce(this._vmapXHR),this._vmapXHR=null),this.playedMidRolls=[],this.duration=0},t.setPreRoll=function(e){this.resetBreakId(e),this.preRoll=e},t.addMidRoll=function(e){this.resetBreakId(e),this.midRolls.push(e),this.duration=0},t.setPostRoll=function(e){this.resetBreakId(e),this.postRoll=e},t.sort=function(e,t){(!e||e<1)&&(e=1),(this.duration!==e||t)&&(this.duration=e,this.midRolls.sort((function(t,i){return ge(t._offSet,e)-ge(i._offSet,e)})),function(e,t){for(var i=0;i<e.length;i++){var s=e[i];t?s._vmap.item=i+1:(s._adbreak={item:i+1,breakid:s._breakId},s._pod?s._adbreak.pod=s._pod:s._adbreak.tags=s._adQueue)}}(this.getAllAds(),t))},t.getAllAds=function(){var e=this.preRoll?[this.preRoll]:[],t=this.postRoll?[this.postRoll]:[];return e.concat(this.midRolls,t)},t.setVMAP=function(e){this.vmap=e},t.isVMAP=function(){return Boolean(this.vmap)},t.getVMAP=function(){return this.vmap},t.getClosestIndex=function(e,t){this.sort(t);for(var i=this.midRolls.length;i--;)if(e>=ge(this.midRolls[i]._offSet,t))return i;return-1},t.resetBreakId=function(e){e.adBreakId=this.utils.genId(12)},t.resetAllBreakIds=function(){var e=this;this.getAllAds().forEach((function(t){e.resetBreakId(t)}))},t.destroy=function(){this.reset(),this.adRules.destroy()},e}(),fe=function(e){return Array.isArray(e)?e.slice(0):[e]},ve=function(e,t){return 0===e?1/0:e||t},ye=function(e,t,i){var s=t.schedule||t.adschedule;if(s){var n={};Object.keys(s).forEach((function(e){var t=s[e];t.ad&&(y(t,t.ad),delete t.ad);var r=function(e,t){if("start"===e||"0%"===e||!e&&0!==e)return"pre";if("end"===e||"100%"===e)return"post";if("pre"===e||"post"===e||(""+e).indexOf("%")>=0)return e;var i=t.seconds(e);return"number"==typeof i&&i}(t.offset,i),a=ve(t.requestTimeout,5e3),o=ve(t.creativeTimeout,5e3),l=n[r];if(l){if("nonlinear"===t.type)return;"nonlinear"===l._type&&(l=null)}var d=n[r]=l||{_offSet:r,_type:t.type,_breakId:e,adBreakId:i.genId(12),requestTimeout:a,creativeTimeout:o};!1===r&&i.log("Error: ad offset format not supported",r);var u=t.skipoffset;if(void 0!==u&&void 0===d.skipoffset&&(d.skipoffset=u),"string"==typeof t.adm)d.adm=t.adm;else if(t.pod){var h=d._pod||[];d._pod=h.concat(t.pod)}else if(t.tag){var c=function(e,t){if(!t)return e;var i=e.indexOf("?")>=0?"&":"?",s=e.indexOf(k),n=k.length,r="",a="";if(Object.keys(t).forEach((function(e){var i=t[e];r=""+r+a+e+"="+i,a="&"})),r=encodeURIComponent(r),s>=0){var o=e.substr(0,s+n),l=e.substr(s+n);return""+o+r+"%26"+l}return""+e+i+k+r}(t.tag,t.custParams);d._adQueue&&(d._pod=[d._adQueue[0]],delete d._adQueue),d._pod?d._pod.push(fe(c)[0]):d._adQueue=fe(c)}else"string"==typeof t.vastxml?d._adXML=t.vastxml:i.log("Error: no ad tag provided")})),Object.keys(n).forEach((function(i){var s=n[i];switch(s.skipoffset=void 0!==s.skipoffset?s.skipoffset:t.skipoffset,i){case"pre":e.setPreRoll(s);break;case"post":e.setPostRoll(s);break;default:e.addMidRoll(s)}}))}},Ae=function(){function e(e){this.utils=e}var t=e.prototype;return t.getSchedule=function(e,t){var i=new me(t,this.utils);if(i.requestTimeout=ve(e.requestTimeout,5e3),i.creativeTimeout=ve(e.creativeTimeout,5e3),e.tag)i.setPreRoll({_offSet:"pre",_adQueue:fe(e.tag),_waterfallIndex:0});else if("string"==typeof e.vastxml)i.setPreRoll({_offSet:"pre",_adXML:e.vastxml});else{if("string"==typeof e.schedule)return i.setVMAP(e.schedule),i;if("string"==typeof e.adschedule)return i.setVMAP(e.adschedule),i;ye(i,e,this.utils)}return i.sort(),i},t.getOptParams=function(e,t){var i={cuetext:t.cuetext,dynamicMessage:t.admessage,loadingAd:t.loadingAd,podMessage:t.podmessage,skipoffset:e.skipoffset,skipMessage:t.skipmessage,skipText:t.skiptext,omidAccessMode:e.omidAccessMode||"full",omidSupport:e.omidSupport||"auto",allowedOmidVendors:e.allowedOmidVendors||[],vpaidcontrols:e.vpaidcontrols||!1,conditionaladoptout:e.conditionaladoptout||!1,requestFilter:e.requestFilter,trackingFilter:e.trackingFilter,withCredentials:void 0===e.withCredentials||e.withCredentials,extensions:"[object Object]"===Object.prototype.toString.call(e.extensions)?e.extensions:{}},s=e.companiondiv;return s&&(i.companion={id:s.id,height:s.height,width:s.width}),i},t.getAdRules=function(e){var t=e.rules||{},i=parseInt(t.frequency,10);return{startOn:t.startOn||1,frequency:isNaN(i)?1:i,timeBetweenAds:t.timeBetweenAds||0,startOnSeek:t.startOnSeek||null,deferAds:t.deferAds||null}},e}();function Pe(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}var we=function(e,t,i){void 0===t&&(t=null),void 0===i&&(i={});var s={client:e.client},n=e.bidding,r=e.item,a=e.player;if(e.isDestroyed()||y(s,{placement:J(a.getConfig()),viewable:a.getViewable()}),i.jwpseg&&(s.jwpseg=i.jwpseg),t){var o=e.getAdIds(t,i),l=o.adBreakId,d=o.adPlayId;if(y(s,{adBreakId:l,adPlayId:d,offset:t._offSet}),n){var u=n.getBid(d);u&&y(s,u.getEventObject())}}return s.item=r,s},be=function(e,t,i,s){return{client:s,message:e,adErrorCode:t,id:b,placement:J(i),tag:""}},ke=function(){function e(e,t){this.player=e,this.options=t,this.client=t.client,this.ignoreStartOnSeek=!1,this.reset(),t.timeBetweenAds&&e.on({adBreakStart:this.handleAdBreakStart,adSkipped:this.handleAdSkipped,adComplete:this.handleAdComplete,adBreakEnd:this.handleAdBreakEnd,destroyPlugin:this.destroy},this)}var t,i,s,n=e.prototype;return n.shouldDeferAds=function(){return this.options.deferAds&&!this.player.getConfig().activeTab},n.clearStartOnSeek=function(){this.ignoreStartOnSeek=!0},n.sendAdBreakIgnored=function(e,t){e&&this.player.trigger(E,function(e,t){var i={};return e&&(i={id:e._breakId,tag:e._adQueue&&e._adQueue.length>0?e._adQueue[0]:e._adXML,offset:e._offSet}),y(i,{timeSinceLastAd:t,type:E})}(e,t,this.client))},n.rulesAllowAdPlayback=function(e){var t=this.options,i=0===t.frequency&&1===e,s=e>=t.startOn&&(e-t.startOn)%t.frequency==0;return i||s},n.handleAdBreakStart=function(){this.adSkipped=!1,this.adComplete=!1},n.handleAdComplete=function(){this.adComplete=!0},n.handleAdSkipped=function(){this.adSkipped=!0},n.handleAdBreakEnd=function(){!this.adSkipped&&this.adComplete&&(this.recentCompletedAdTime=H())},n.timeBetweenAdsAllowsAdPlayback=function(e,t){if(void 0===t&&(t=H()),this.options.timeBetweenAds){var i=(t-this.recentCompletedAdTime)/1e3;if(i<this.options.timeBetweenAds)return this.sendAdBreakIgnored(e,i),!1}return!0},n.reset=function(){this.ignoreStartOnSeek=!1,this.recentCompletedAdTime=0},n.destroy=function(){this.player.off(null,null,this)},t=e,(i=[{key:"timeBetweenAds",get:function(){return this.options.timeBetweenAds}},{key:"startOnSeek",get:function(){return this.ignoreStartOnSeek?null:this.options.startOnSeek}}])&&Pe(t.prototype,i),s&&Pe(t,s),Object.defineProperty(t,"prototype",{writable:!1}),e}(),Ee=function(){},Me=function(){function e(e,t,i){this.player=e,this.pluginConfig=t,this.adClient=i;var s=this.configParser=new Ae(e.utils),n=this.adRules=new ke(e,s.getAdRules(t),i);this.emptySchedule=new me(n,e.utils)}var t=e.prototype;return t.getAdRules=function(){return this.adRules},t.resetDefaultSchedule=function(e){var t=void 0===this.pluginConfig.withCredentials||this.pluginConfig.withCredentials,i=this.defaultSchedule=this.configParser.getSchedule(this.pluginConfig,this.adRules);i.isVMAP()&&i.load(this.player,e,this.adClient,{withCredentials:t}).catch(Ee)},t.getSchedule=function(e,t){return t>0&&!this.adRules.rulesAllowAdPlayback(t)?this.emptySchedule:e&&e.adschedule?this.configParser.getSchedule(e,this.adRules):(this.resetDefaultSchedule(e),this.defaultSchedule)},t.getOptParams=function(e,t){return this.configParser.getOptParams(e,t)},t.reset=function(){this.adRules.reset()},t.destroy=function(){this.emptySchedule&&this.emptySchedule.destroy(),this.defaultSchedule&&this.defaultSchedule.destroy()},e}(),Ce=function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");return Object.prototype.hasOwnProperty.call(Object(e),t)},_e={adPosition:"",autoplayadsmuted:!1,companiondiv:null,companionResourceType:"",customUi:null,debug:!1,omidSupport:"disabled",omidAccessModeRules:{},enablePreloading:!1,loadVideoTimeout:15e3,locale:"",maxRedirects:-1,ppid:"",preloadAds:!1,requestTimeout:1e4,truncateMacros:!0,vastLoadTimeout:1e4,vpaidcontrols:!1,vpaidmode:"insecure"},Ie=function(e){if("true"===e)return!0;if("false"===e)return!1;var t=parseFloat(e);return isNaN(t)?e:t},Re=function(){function e(e,t){for(var i in this.config=e,this.utils=t,this.bidsResponse={},_e)if(Ce(_e,i)){var s=e[i],n=_e[i],r=typeof n;if(void 0!==s){if("boolean"!==r&&"number"!==r||(s=Ie(s)),typeof s!==r)throw new Error("invalid parameter: "+i+" should be a "+r);this[i]=s}else this[i]=n}}return e.prototype.setLocalizationOptions=function(e){var t=e.admessage,i=e.cuetext,s=e.podmessage,n=e.loadingAd,r=e.skipmessage,a=e.skiptext;this.admessage=t,this.cuetext=i,this.loadingAd=n,this.podmessage=s,this.skipmessage=r,this.skiptext=a},e}(),Se=function(){function e(e,t,i){i.addClass(e,"jw-plugin-googima");var s=document.createElement("div");s.id=t+"_ad",s.className="jw-ads-view",this.visible=!1,this.utils=i,this.div=e,this.adDiv=s,e.appendChild(s)}var t=e.prototype;return t.resizeNonLinear=function(e){this.resize(!1,e)},t.resizeLinear=function(){this.resize(!0)},t.resize=function(e,t){var i=this.utils;i.toggleClass(this.div,"jw-ad-non-linear",!e),i.toggleClass(this.div,"jw-ad-linear",e),i.style(this.div,{height:t?t+"px":""})},t.getAdDiv=function(){return this.adDiv},t.adSetup=function(){this.visible=!0,this.utils.addClass(this.div,"jw-ad-instream"),this.resize(!0)},t.adTakeDown=function(){this.visible=!1,this.utils.removeClass(this.div,"jw-ad-instream"),this.resize(!0)},e}(),Le=null;function Te(e){if(Le)return Le;if(window.google&&google.ima&&google.ima.AdDisplayContainer)return Le=Promise.resolve();var t=["//","imasdk.googleapis.com/js/sdkloader/ima3.js"];"file:"===document.location.protocol&&t.unshift("https:");var i=new(0,e.scriptloader)(t.join(""));return Le=i.load()}var je=function(){function e(e,t,i){e.extend(this,t),this.vol=0,this.imaProxy=null,this.view=i}var t=e.prototype;return t.setProxy=function(e){this.imaProxy=e,"boolean"==typeof this.muted&&this.mute(this.muted)},t.attachMedia=function(){},t.detachMedia=function(){},t.mute=function(e){this.muted=e,this.imaProxy&&(e?this.imaProxy.setVolume(0):this.vol&&this.imaProxy.setVolume(this.vol)),this.muteAllAdContainerVideo(e)},t.muteAllAdContainerVideo=function(e){for(var t=this.view.getAdDiv().getElementsByTagName("video"),i=0;i<t.length;i++)t[i].muted=e},t.volume=function(e){this.vol=e/100,this.imaProxy&&this.imaProxy.setVolume(this.vol)},e}();function xe(e,t){return xe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},xe(e,t)}var Be=function(){},De=function(){function e(e,t,i,s,n){y(this,e.Events),this.client="shared",this.player=e,this.item=i,this.config=s,this.casting=n;var r=e.utils,a=new Ae(r);this.adRules=new ke(e,a.getAdRules(s)),"string"==typeof t?(this.schedule=new me(this.adRules,r),this.schedule.setPreRoll({tag:t})):(this.schedule=t,t.resetAllBreakIds()),this.vmapPromise=null,this.lastTimeEvent=null,this.prerollPromise=null,this.midrollPromise={},this.postrollPromise=null,this.next=null,this.nextPlaylistItemPromise=null,this.relatedNextUp=null,this.bidding=e.getPlugin("bidding"),this.bids=[],this.bidsPromises=[],this.bidsPromise=null,this._events=[]}var t=e.prototype;return t.attachListeners=function(){this.player.on({all:this.onAll,beforePlay:this.checkPreroll,relatedReady:this.relatedReady,cast:this.onCast,destroyBidding:this.destroyBids},this)},t.onAll=function(e,t){"time"===e?this.checkMidrolls(t):"beforeComplete"===e&&this.checkPostrolls(t)},t.relatedReady=function(){var e=this;if(this.config.preloadAds){var t=this.player.getPlugin("related");t&&t.on("nextUp",(function(t){t&&"discovery"===t.mode&&(e.relatedNextUp=t)}))}},t.onCast=function(e){this.casting=Boolean(e.active)},t.init=function(e,t){var i=this;if(e=e||null,this.schedule.isVMAP()&&(t.requestTimeout=this.schedule.requestTimeout,t.creativeTimeout=this.schedule.creativeTimeout,this.vmapPromise=this.schedule.load(this.player,this.item,this.client,t)),this.bidsPromise=this.vmapPromise||Promise.resolve(),this.bidsPromise=null!==e?this.bidsPromise.then((function(){if(!i.isDestroyed()){if(i.bidding)return i.createBidsPromise(e,t);var s=function(e,t,i){var s=we(e,t,i);return y(s,{message:"Ad Error: bidding plugin unavailable",code:900,adErrorCode:60008}),s}(i,null,t);i.player.trigger(M,s)}})).catch(Be):this.bidsPromise.catch(Be),this.config.preloadAds)if(1===t.playlistItemEventCount){var s=this.player.getConfig().autostart;!1===s||"viewable"===s&&0===this.player.getViewable()?this.loadPreroll(t).catch((function(e){return i.isDestroyed()?null:i.enqueueAdEvent(M,e,{preload:!0})})):this.player.once("autostartNotAllowed",(function(){i.loadPreroll(t).catch((function(e){return i.isDestroyed()?null:i.enqueueAdEvent(M,e,{preload:!0})}))}))}else t.preloadPreroll&&this.loadPreroll(t).catch((function(e){return i.isDestroyed()?null:i.enqueueAdEvent(M,e,{preload:!0})}));return this.bidsPromise},t.createBidsPromise=function(e,t){var i=this,s=this.player,n=parseInt(e.bidOnBreaks,10);return n=n>0?n:1/0,this.bids=this.schedule.getAllAds().slice(0,n).map((function(n){var r=i.getAdIds(n).adPlayId,a=s.getConfig(),o=i.config.skipoffset,l=null!=o&&o>=0,d=F(s,i.item),u={id:r,offset:e.offset,jwpseg:d,placement:J(a),tag:n._adQueue?n._adQueue[0]:n._currentTag,adClient:i.client};i.client===A&&(u.skipoffset=l?o:-1);var h=i.bidding.createNewBid(u,{getURLParts:X});i.player.trigger("adBidRequest",we(i,n,y({jwpseg:d},t))),h.init();var c=h.start().then((function(e){var s=e.result;if(!i.isDestroyed()){var r=Promise.resolve();return s&&!s.error&&(n.jwpseg=d,s.adm?(n._adXML=s.adm,n._adQueue&&n._adQueue.length&&n._adQueue.unshift(s.adm)):s.tag&&(r=ee(s.tag,i.player,i.item,i.client,{},n).then((function(e){i.client===A?(n._adQueue=n._adQueue||[],n._adQueue.unshift(e)):n._adQueue=[e]})))),i.player.trigger("adBidResponse",we(i,n,t)),r}}));return i.bidsPromises.push(c),h})),Promise.all(this.bidsPromises)},t.checkPreroll=function(e){var t=this;if(this.bidTimeoutStarted||(this.bidTimeoutStarted=!0,this.bids.forEach((function(e){return e.timeout()}))),!(this.casting||this.preRollPlayed||this.adRules.shouldDeferAds())){this.preRollPlayed=!0;var i=(e||{}).startTime||this.player.getPosition();this.lastTimeEvent=i||this.lastTimeEvent;var s=this.schedule.getPreRoll(i);if(s||this.vmapPromise){(null!==this.vmapPromise||s&&"nonlinear"!==s._type)&&this.startBlocking(),this.bidsPromise.then((function(){if(!t.isDestroyed()){var e=t.schedule.getPreRoll(i);e&&"nonlinear"!==e._type&&t.triggerAdBreakEvents(e,"pre")}})),i?"none"===this.adRules.startOnSeek&&(this.prerollPromise=null):this.adRules.clearStartOnSeek();var n=e&&e.playReason?e.playReason:"external";this.playPreroll({adBlock:this.adBlockErrorDetected,startTime:i,reason:n})}}},t.checkMidrolls=function(e){var t=this;if(!this.casting&&0!==e.duration&&!this.adRules.shouldDeferAds()){var i=this.schedule.getNextMidrollIndex(this.lastTimeEvent,e.position,e.duration);if(this.lastTimeEvent=e.position,null!==i){var s=this.schedule.getMidRollAtIndex(i);"nonlinear"!==s._type&&(this.startBlocking(),this.triggerAdBreakEvents(s,"mid")),this.playMidrollAtIndex(i,{adBlock:this.adBlockErrorDetected})}else if(!this.preRollPlayed&&this.schedule.getClosestIndex(e.position,e.duration)<0)this.checkPreroll(e);else if(this.config.preloadAds){var n=e.position+5,r=this.schedule.peek(e.position,n,e.duration);if(null!==r&&r>=0)this.loadMidrollAtIndex(r,{adBlock:this.adBlockErrorDetected,preload:!0}).catch(Be);else if(-1===r){var a=H()+1e3*(e.duration-e.position);this.loadPostroll({adBlock:this.adBlockErrorDetected,preload:!0,startTime:a}).catch(Be)}else if(null===this.next&&null===this.nextPlaylistItemPromise&&n>e.duration){var o=this.player.getPlaylistIndex()+1,l=this.player.getPlaylistItem(o);if(this.nextPlaylistRelated=Boolean(this.relatedNextUp),l||this.relatedNextUp){var d=this.relatedNextUp?-1:o;this.nextPlaylistItemPromise=Promise.resolve(this.player.getPlaylistItemPromise(d)).then((function(){t.isDestroyed()||(t.trigger("preloadNext",{item:t.player.getPlaylistItem(o)||t.relatedNextUp,index:d}),t.relatedNextUp=null,t.nextPlaylistItemPromise=null)})).catch(Be)}}}}},t.checkPostrolls=function(e){if(!(this.casting||this.adRules.shouldDeferAds()||this.isDestroyed())){var t=this.schedule.getPostRoll();t&&("nonlinear"!==t._type&&(this.startBlocking(),this.triggerAdBreakEvents(t,"post")),this.playPostroll(e))}},t.getAdIds=function(e,t){var i=void 0===t?{}:t,s=i.tagIndex,n=i.podIndex,r=e.adRequestIds&&void 0!==s?e.adRequestIds[s]:null;if(!r){var a="p"+(n||e._adPodIndex||0)+"w"+(e._waterfallIndex||0);"p0w0"===a?r=e.adBreakId:(e.adPlayIds=e.adPlayIds||{},r=e.adPlayIds[a]=e.adPlayIds[a]||this.player.utils.genId(12))}return{adBreakId:e.adBreakId,adPlayId:r}},t.loadPreroll=function(e){var t=this;return void 0===e&&(e={}),this.prerollPromise||(this.prerollPromise=this.bidsPromise.then((function(){if(!t.isDestroyed()){var i=t.schedule.getPreRoll(e.startTime);return i?(i._position="pre",i._preload=!0,t.loadAd(i,e)):void 0}}))),this.prerollPromise},t.loadMidrollAtIndex=function(e,t){var i=this;return this.midrollPromise[e]||(this.midrollPromise[e]=this.bidsPromise.then((function(){if(!i.isDestroyed()){var s=i.schedule.getMidRollAtIndex(e);return s?(s._position="mid",s._preload=!0,i.loadAd(s,t)):void 0}}))),this.midrollPromise[e]},t.loadPostroll=function(e){var t=this;return void 0===e&&(e={}),this.postrollPromise||(this.postrollPromise=this.bidsPromise.then((function(){if(!t.isDestroyed()){var i=t.schedule.getPostRoll(e.startTime);return i?(i._position="post",i._preload=!0,t.loadAd(i,e)):void 0}}))),this.postrollPromise},t.playPreroll=function(e){var t=this;this.prerollPromise?this.playPreloadedPromise(this.prerollPromise,e):this.bidsPromise.then((function(){if(!t.isDestroyed()){var i=t.schedule.getPreRoll(e.startTime);i?(i._position="pre",t.startAdBreak(i,e)):t.stopBlocking()}}))},t.playMidrollAtIndex=function(e){var t=this;this.midrollPromise[e]?this.playPreloadedPromise(this.midrollPromise[e]):this.bidsPromise.then((function(){var i=t.schedule.getMidRollAtIndex(e);i&&(i._position="mid",t.startAdBreak(i))}))},t.playPostroll=function(e){var t=this;this.postrollPromise?this.playPreloadedPromise(this.postrollPromise):this.bidsPromise.then((function(){var i=t.schedule.getPostRoll();i&&(i._position="post",t.startAdBreak(i,e))}))},t.isDestroyed=function(){return null===this.player},t.destroy=function(){this.destroyBids(),this.player.off(null,null,this),this.player=null},t.destroyBids=function(){this.bids.forEach((function(e){return e.stop()})),this.bidsPromises=[],this.bids=[]},t.enqueueAdEvent=function(e,t,i){this._events.push({type:e,event:t}),i.preload||this.dequeueAdEvents()},t.dequeueAdEvents=function(){},t.triggerAdBreakEvents=function(){},t.startBlocking=function(){},t.stopBlocking=function(){},t.loadAd=function(){},t.playPreloadedPromise=function(){},t.startAdBreak=function(){},e}(),Oe=function(e){var t=e.advertising;if(t&&t.placement){var i=t.placement.toLowerCase();if(v[i])return v[i]}return v[t&&t.outstream?f:m]},qe=function(e,t){var i=function(e,t){if("start"===e||"0%"===e)return"pre";if("end"===e||"100%"===e)return"post";if("string"==typeof e&&("pre"===e||"post"===e||e.indexOf("%")>=0))return e;var i=t.seconds(e);return"number"==typeof i&&!isNaN(i)&&i}(e,t);return"pre"===i?0:"post"===i?-1:i},Ue=function(e,t){if(e&&e[t]&&"function"==typeof e[t])try{for(var i=arguments.length,s=new Array(i>2?i-2:0),n=2;n<i;n++)s[n-2]=arguments[n];return e[t].apply(e,s)}catch(e){return null}return null},Ve=function(e,t,s,n){void 0===n&&(n={}),t=t||null;var r={client:i};if(!e)return r;var a=e.bidding,o=e.config,l=e.player;y(r,{placement:Oe(l.getConfig()),viewable:l.getViewable()}),n.jwpseg&&(r.jwpseg=n.jwpseg),o.preloadAds&&(r.preloadAds=n.preload||s&&s._preload||!1);var d=Ue(t,"getAdPodInfo");if(d){var u=Ue(d,"getTotalAds");if(u>1){var h=Ue(d,"getAdPosition");y(r,{sequence:h,podcount:u}),n.podIndex="number"==typeof h?h-1:0}if(void 0===r.adposition){var c=Ue(d,"getTimeOffset");r.adposition=0===c?"pre":-1===c?"post":"mid"}}if(s){var p=e.getAdIds(s,n),g=p.adBreakId,m=p.adPlayId;if(y(r,{tag:s._adQueue&&s._adQueue.length>0?s._adQueue[0]:s._adXML||s.adm,adBreakId:g,adPlayId:m,id:g,adposition:s._position}),s.jwpseg&&(r.jwpseg=s.jwpseg),a){var f=a.getBid(m);f&&y(r,f.getEventObject())}}var v=e.adsLoaderManager||n.loader;if(t){if(v){var A=r.mediationLayerAdServer;if("dfp"===A||"jwpdfp"===A)-1!==(Ue(t,"getWrapperAdSystem")||[]).concat(Ue(t,"getAdSystem")||[]).indexOf("SpotXJW")&&r.bidders.forEach((function(e){e.winner="SpotX"===e.name}));var P=v.userRequestContext;y(r,{tag:r.tag||v.getTag(t),ima:{ad:t,userRequestContext:P}})}y(r,{adtitle:t.getTitle(),adsystem:t.getAdSystem(),creativetype:t.getContentType(),duration:t.getDuration(),linear:t.isLinear()?"linear":"nonlinear",description:t.getDescription(),creativeAdId:t.getCreativeAdId(),adId:t.getAdId(),universalAdId:t.getUniversalAdIds().map((function(e){return{universalAdIdRegistry:e.g,universalAdIdValue:e.h}})),advertiser:t.getAdvertiserName(),dealId:t.getDealId()});var w=t.getMediaUrl();w&&(r.mediaFile={file:w})}return void 0!==n.offset&&y(r,{adposition:r.adposition||n.offset,offset:n.offset}),r},Ne=function(e,t,i,s,n){var r=Ve(e,i,s,n),a=t.getVastErrorCode?t.getVastErrorCode():t.code,o=t.getErrorCode?t.getErrorCode():t.adErrorCode;return o=o<1e4?o+2e4:o||60900,y(r,{message:"Ad Error: "+(t.getMessage?t.getMessage():t.message),code:a>=100&&a<=1008?a:900,adErrorCode:o}),e&&(20402===o?r.timeout=e.options.loadVideoTimeout:21009===o?r.timeout=e.options.vastLoadTimeout:60004===o&&(r.timeout=e.options.requestTimeout)),void 0!==t.placement&&(r.placement=t.placement),void 0!==t.id&&(r.id=t.id),t.getInnerError&&(r.sourceError=t.getInnerError()),void 0!==t.tag&&(r.tag=t.tag),r},He=function(e){return e.isBeforePlay()||0===e.getPosition()?"pre":e.isBeforeComplete()||e.getPosition()===e.getDuration()?"post":"mid"},ze=function(){return null},Qe=function(){function e(e,t){var i=e.player,s=e.options,n=e.instreamProvider,r=e.view,a=e.adsLoaderManager,o=e.video,l=e.item,d=e.client;if(i.utils.extend(this,i.Events),this.playlistItemManager=e,this.player=i,this.options=s,this.instreamProvider=n,this.view=r,this.adsLoaderManager=a,this.video=o,this.item=l,this.client=d,this.reason=t,this.env=i.getEnvironment(),this.utils=i.utils,this._qoe=new i.utils.Timer,s.customUi){var u=s.customUi;this.mainContainer=i.getContainer(),this.customUiDiv=document.getElementById(u.customUiDivId),this.adClickButton=document.getElementById(u.adClickButtonId),this.customCountDownDiv=document.getElementById(u.customCountDownId),this.customSkipButton=document.getElementById(u.customSkipButtonId),this.timeTillSkip=Number.POSITIVE_INFINITY}this.initAdsManagerPromise=null,this.blockingInstreamPlayer=null,this.currentAd=null,this.progressIntervalId=-1,this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=ze,this.paused=!1,this.playbackProxy={currentTime:this.player.getPosition(),duration:this.player.getDuration()},i.on("time",this.time,this),this.debugConsoleLog=ze,s.debug&&(this.debugConsoleLog=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log(t)})}var t=e.prototype;return t.time=function(e){this.playbackProxy.currentTime=e.position,e.duration>=e.position?this.playbackProxy.duration=e.duration:this.playbackProxy.duration=1/0},t.init=function(e,t,i){var s=this;this.requestType=e,this.requestOptions=t,this.scheduledAd=i,this.offset=i._offset;var n=this.adsLoaderManager;return this.initAdsManagerPromise=this.initAdsManagerPromise||Te().then((function(){return s.destroyed()?null:(s.debugConsoleLog("[JW DEBUG] Open adsLoaderManager"),n.open(e,t,s.video))})).then((function(e){if(s.destroyed())return null;var i=n.getAdsManager(e,s.playbackProxy,s.options);if(s.instreamProvider.setProxy(i),n.bindEvents({AD_ERROR:s.adError.bind(s),LOADED:s.adLoaded.bind(s),CONTENT_PAUSE_REQUESTED:s.pauseRequested.bind(s),CONTENT_RESUME_REQUESTED:s.resumeRequested.bind(s),LOG:s.adLog.bind(s),STARTED:s.adStarted.bind(s),IMPRESSION:s.adImpression.bind(s),LINEAR_CHANGED:s.resize.bind(s),CLICK:s.adClick.bind(s),PAUSED:s.adPaused.bind(s),RESUMED:s.adResumed.bind(s),SKIPPED:s.adSkipped.bind(s),USER_CLOSE:s.adUserClose.bind(s),ALL_ADS_COMPLETED:s.allAdsCompleted.bind(s)},s),t.preloadAds)clearTimeout(s.timeoutAdStart);else{var r=s.player.getSafeRegion(!1),a=r.width,o=r.height,l=s.getViewMode();s.debugConsoleLog("[JW DEBUG] adsManager init with",a,o,l),n.init(a,o,l)}var d=i.getCuePoints();if(d.length){var u=d.filter((function(e){return e>0})).map((function(e){return{begin:e,text:s.options.cuetext,cueType:"ads"}}));s.player.addCues(u)}return i})).catch((function(e){if(clearTimeout(s.timeoutAdStart),s.asyncError&&!i._preload&&s.asyncError(e),e&&e.getError){var t=e.getError();throw s.getAdErrorEventObject(t,e)}throw e})),this.initAdsManagerPromise},t.getViewMode=function(){var e=google.ima.ViewMode;return this.player.getFullscreen()?e.FULLSCREEN:e.NORMAL},t.beforeComplete=function(){var e=this.adsLoaderManager.adsManager;e&&e.getCuePoints().indexOf(-1)>-1&&this.playlistItemManager.startBlocking(),this.adsLoaderManager.unbindEvents(["CONTENT_RESUME_REQUESTED"]),this.debugConsoleLog("[JW DEBUG] Call contentComplete on IMA SDK"),this.adsLoaderManager.contentComplete()},t.requestAds=function(){var e=this;if(!this.destroyed()){this.debugConsoleLog("[JW DEBUG] Request ads to IMA SDK");var t=Promise.resolve();if(this.scheduledAd._adQueue&&this.scheduledAd._adQueue.length){var i=this.scheduledAd._adQueue.map((function(t,i){return ee(t,e.player,e.item,e.client,e.options,e.scheduledAd).then((function(t){t=$(e.player,e.item,t),e.scheduledAd._adQueue[i]=t}))}));t=Promise.all(i)}return t.then((function(){e.startRequestTimeout(),e.trigger("adRequest",Ve(e.playlistItemManager,null,e.scheduledAd)),e.adsLoaderManager.requestAds(e.requestType,e.requestOptions,e.options,e.scheduledAd)}))}},t.muteInstreamProvider=function(){var e=this.video.muted||this.player.getMute();this.debugConsoleLog("[JW DEBUG] Setting mute on instreamProvider",e),this.instreamProvider.mute(e)},t.pauseRequested=function(e){var t=this.playlistItemManager.schedule.isVMAP();t&&this.playlistItemManager.startBlocking();var i=e&&e.getAd();if(t){var s=Ue(i,"getAdPodInfo"),n=Ue(s,"getTimeOffset");if(n){var r=-1===n?"post":"mid";this.scheduledAd._position=r,this.playlistItemManager.triggerAdBreakEvents(this.scheduledAd,r)}}var a=Ve(this.playlistItemManager,i,this.scheduledAd);this.trigger(u,a)},t.resumeRequested=function(){this.debugConsoleLog("[JW DEBUG] ResumeRequest from IMA SDK"),this.currentAd&&this.currentAd.isLinear()&&this.finishAd(),this.blockingInstreamPlayer&&this.view.adTakeDown(),this.trigger("stopBlocking"),this.blockingInstreamPlayer=null},t.finishAd=function(){this.currentAd&&(this.hideCustomUi(),clearInterval(this.progressIntervalId),this.viewablePlayedTime=0,this.currentAd=null)},t.discardAdBreak=function(e){!e&&this.adsLoaderManager&&(e=this.adsLoaderManager.adsManager),!this.destroyed()&&e&&(0===e.getCuePoints().length?this.destroy():(e.discardAdBreak(),e.stop()))},t.asyncDiscardAdBreak=function(){var e=this;this.initAdsManagerPromise&&this.initAdsManagerPromise.then((function(t){return e.discardAdBreak(t)})).catch(ze)},t.pause=function(e){var t=e.reason;if(!this.destroyed()){var i=this.adsLoaderManager.adsManager;i&&(this.viewablePlayedTime=0,this.debugConsoleLog("[JW DEBUG] JW Player pause ad"),this.reason=t||p,i.pause())}},t.resume=function(e){var t=e.reason;if(!this.destroyed()){var i=this.adsLoaderManager.adsManager;i&&(this.debugConsoleLog("[JW DEBUG] JW Player resume ad"),this.reason=t||p,i.resume())}},t.startRequestTimeout=function(){var e=this;clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout((function(){e.debugConsoleLog("[JW DEBUG] Ad request timeout"),e.destroyed()||(e.asyncError=null,e.handleAdError({message:"Ad Request timeout after "+e.options.requestTimeout+" milliseconds",getErrorCode:function(){return 60004}}),e.asyncDiscardAdBreak())}),this.options.requestTimeout)},t.startAdsLoader=function(e){var t=this;if(this.destroyed()||!this.initAdsManagerPromise)return Promise.reject();this.player.off("beforePlay",null,this),e&&(this.blockingInstreamPlayer=e,e.setText(this.options.loadingAd)),this.muteInstreamProvider(),this._qoe.tick("adBeforePlay"),this.startRequestTimeout(),this.initAdsManagerPromise.then((function(){if(!t.destroyed()){var e=t.adsLoaderManager;if(!e.initialized){var i=t.player.getSafeRegion(!1),s=i.width,n=i.height,r=t.getViewMode();t.debugConsoleLog("[JW DEBUG] adsManager init with",s,n,r),e.init(s,n,r)}t.debugConsoleLog("[JW DEBUG] Start adsManager"),e.start()}})).catch(ze)},t.resize=function(){var e=this.currentAd,t=this.adsLoaderManager.adsManager;if(t){var i=e&&!e.isLinear(),s=this.player.getSafeRegion(i);if(i){var n=e.getHeight();n=this.player.getFullscreen()?s.height/2:Math.max(100,n+10),this.debugConsoleLog("[JW DEBUG] Resize adsManager",s.width,n,this.getViewMode()),t.resize(s.width,n,this.getViewMode()),this.view.resizeNonLinear(n)}else this.debugConsoleLog("[JW DEBUG] Resize adsManager",s.width,s.height,this.getViewMode()),t.resize(s.width,s.height,this.getViewMode()),this.view.resizeLinear()}},t.setState=function(e,t,i){if(e.isLinear()){var s=Ve(this.playlistItemManager,e,this.scheduledAd);if(s.newstate=t,i&&(s.oldstate=i),null!==this.reason)s[t===l?"playReason":"pauseReason"]=this.reason,this.reason=null;this.instreamProvider.trigger("state",s)}},t.customMainClickHandler=function(){this.adsLoaderManager.adsManager.resume()},t.customSkipHandler=function(e){(e.stopPropagation(),this.timeTillSkip<=0)&&this.adsLoaderManager.adsManager.skip()},t.customClickHandler=function(e){e.stopPropagation(),this.adsLoaderManager.adsManager.clicked()},t.addCustomEventHandlers=function(){this.mainClick=this.customMainClickHandler.bind(this),this.customSkip=this.customSkipHandler.bind(this),this.customClick=this.customClickHandler.bind(this),this.mainContainer.addEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.addEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.addEventListener("click",this.customSkip)},t.removeCustomEventHandlers=function(){this.mainContainer.removeEventListener("click",this.mainClick),this.adClickButton&&this.adClickButton.removeEventListener("click",this.customClick),this.customSkipButton&&this.customSkipButton.removeEventListener("click",this.customSkip)},t.showCustomUi=function(){this.customUiDiv&&(this.customUiDiv.style.display="block",this.addCustomEventHandlers())},t.hideCustomUi=function(){this.customUiDiv&&(this.customUiDiv.style.display="none",this.removeCustomEventHandlers())},t.adLoaded=function(e){clearTimeout(this.timeoutAdStart);var t=e.getAd();if(this.playlistItemManager.schedule.isVMAP()){var i=Ue(t,"getAdPodInfo"),s=Ue(i,"getTimeOffset");s&&(this.scheduledAd._position=-1===s?"post":"mid")}var n=Ve(this.playlistItemManager,t,this.scheduledAd);this.trigger("adLoaded",n)},t.adStarted=function(e){this.player.getPip()&&this.player.requestPip(this.view.getAdDiv().querySelector("video"));var t=e.getAd();this.currentAd=t,this.paused=!1,t.isUiDisabled()&&this.showCustomUi();var i=Ve(this.playlistItemManager,t,this.scheduledAd);this.trigger(h,i)},t.adImpression=function(e){var t=this;this.view.adSetup();var i=e.getAd(),s=i.isLinear(),n=s&&(i.getContentType().indexOf("image")>=0||-1===i.getDuration()),r=this.isVpaidAd(i),d=s&&r&&this.options.vpaidcontrols;this.currentAd=i,this.blockingInstreamPlayer&&this.blockingInstreamPlayer.setSkipOffset(i.getSkipTimeOffset()),this.adsLoaderManager.bindEvents({COMPLETE:this.adComplete.bind(this)}),r&&this.env.OS.mobile&&this.options.autoplayadsmuted&&this.adsLoaderManager.bindEvents({VOLUME_CHANGED:function(){t.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"]),t.player.setMute(0===t.adsLoaderManager.adsManager.getVolume())}}),s||this.trigger("stopBlocking",{isNonlinear:!0}),this.utils.toggleClass(this.player.getContainer(),a,s&&(n||r)),this.utils.toggleClass(this.player.getContainer(),o,d),this.resize(),this.muteInstreamProvider(),clearTimeout(this.timeoutAdStart);var h=this.adsLoaderManager.adsManager;this.progressInterval(i,h);var c=Ve(this.playlistItemManager,i,this.scheduledAd),p=void 0===c.podcount||1===c.sequence;"pre"===c.adposition&&p&&(this._qoe.tick("adImpression"),c.timeLoading=this._qoe.between("adBeforePlay","adImpression")),s&&!p&&this.trigger(u,c),this.trigger("adImpression",c,i),this.setupViewableListener(),this.setState(i,l,"buffering")},t.progressInterval=function(e,t){var i=this;if(clearInterval(this.progressIntervalId),t){var s=e.getAdId(),n=e.isSkippable()&&this.customSkipButton,r=-1,a=this.options.admessage||"",o=this.options.podmessage||"",l=this.options.skipmessage||"",d=this.options.skiptext||"",u=new RegExp("__AD_POD_CURRENT__","g"),h=new RegExp("__AD_POD_LENGTH__","g");this.progressIntervalId=setInterval((function(){if(i.currentAd&&i.currentAd.getAdId()===s){var c=t.getRemainingTime();if(!(isNaN(c)||c<=0)&&r!==c){r=c;var p=i.currentAd.getDuration(),g=p-c,m=Math.round(p-g);if(n){var f=i.timeTillSkip=Math.ceil(e.getSkipTimeOffset()-g);f>0?(i.customSkipButton.innerText=l.replace(/(\b)xx(s?\b)/g,"$1"+f+"$2"),i.customSkipButton.style.cursor="default"):(i.customSkipButton.innerText=d,i.customSkipButton.style.cursor="pointer")}if(i.blockingInstreamPlayer){var v=a.replace(/(\b)xx(s?\b)/g,"$1"+m+"$2"),y=Ue(i.currentAd,"getAdPodInfo");if(y){var A=Ue(y,"getTotalAds");if(A>1){var P=Ue(y,"getAdPosition");v=o.replace(u,P).replace(h,A)+"  "+v}}i.blockingInstreamPlayer.setText(v),i.customCountDownDiv&&(i.customCountDownDiv.innerText=v),i.instreamProvider.trigger("time",{duration:p,position:g})}if(p>0){var w=Ve(i.playlistItemManager,e,i.scheduledAd);w.position=g,w.duration=p,i.adViewableImpressionHandler(w),i.trigger("adTime",w)}}}else clearInterval(i.progressIntervalId)}),250)}},t.setupViewableListener=function(){this.player.off(c,this.viewableHandler,this),this.player.on(c,this.viewableHandler,this),this.viewableHandler({viewable:this.player.getViewable()})},t.adViewableHandler=function(e){var t=e.position;null===this.lastPosition&&(this.lastPosition=t);var i=t-this.lastPosition;if(this.lastPosition=t,i=Math.min(Math.max(0,i),4),this.viewablePlayedTime+=i,this.viewablePlayedTime>=2){this.player.off(c,this.viewableHandler,this),this.adViewableImpressionHandler=ze;var s=Ve(this.playlistItemManager,this.currentAd,this.scheduledAd);this.trigger("adViewableImpression",s)}},t.viewableHandler=function(e){e.viewable?(this.viewablePlayedTime=0,this.lastPosition=null,this.adViewableImpressionHandler=this.adViewableHandler):this.adViewableImpressionHandler=ze},t.adComplete=function(e){var t=e.getAd();this.finishAd();var i=Ve(this.playlistItemManager,t,this.scheduledAd);this.trigger("adComplete",i),this.adsLoaderManager.unbindEvents(["VOLUME_CHANGED"])},t.adClick=function(e){var t=this.adsLoaderManager.adsManager,i=e.getAd();this.reason="clickthrough",this.isVpaidAd(i)||(this.debugConsoleLog("[JW DEBUG] Ad paused due to ad click"),t.pause());var s=Ve(this.playlistItemManager,i,this.scheduledAd);this.trigger("adClick",s)},t.adPaused=function(e){if(!this.paused){this.paused=!0;var t=e.getAd();null===this.reason&&this.isVpaidAd(t)&&(this.reason=g),this.setState(t,"paused")}},t.adResumed=function(e){if(this.paused){this.paused=!1;var t=e.getAd();null===this.reason&&this.isVpaidAd(t)&&(this.reason=g),this.setState(t,l)}},t.adSkipped=function(e){var t=e.getAd();this.debugConsoleLog("[JW DEBUG] AdSkipped"),this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd();var i=Ve(this.playlistItemManager,t,this.scheduledAd);this.trigger("adSkipped",i)},t.adUserClose=function(e){this.debugConsoleLog("[JW DEBUG] AdUserClose"),this.currentAd&&this.currentAd.isLinear()&&-1===this.currentAd.getDuration()?this.adSkipped(e):(this.adsLoaderManager.unbindEvents(["COMPLETE","VOLUME_CHANGED"]),this.finishAd())},t.allAdsCompleted=function(){this.resumeRequested(),this.stopAdsManager(),this.trigger("allAdsComplete",{})},t.stopAdsManager=function(){var e=this;this.initAdsManagerPromise.then((function(t){e.destroyed()||(e.debugConsoleLog("[JW DEBUG] Stop IMA SDK adsManager"),t.stop(),t.destroy(),e.initAdsManagerPromise=null)})).catch(ze)},t.adLog=function(e){this.debugConsoleLog("[JW DEBUG]",e.type,e);var t=Ue(e,"getAdData"),i=t&&t.adError;if(i&&402===i.getVastErrorCode())this.handleAdError(i,e);else if(i){var s=Ue(e,"getAd");this.trigger(d,Ne(this.playlistItemManager,i,s,this.scheduledAd,{jwpseg:this.adsLoaderManager.getJwpSeg(s)}))}},t.adError=function(e){var t=e.getError();this.handleAdError(t,e)},t.asyncError=function(e){var t=this;if(!this.destroyed())if(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout((function(){return t.destroy()}),0),e&&e.getError){var i=e.getError();this.handleAdError(i,e,!0)}else e.target&&e.target.src?console.error("Failed to load "+e.target.src):console.error(e)},t.getAdErrorEventObject=function(e,t){var i=Ue(t,"getUserRequestContext"),s=i?i.offset:void 0;return Ne(this.playlistItemManager,e,null,this.scheduledAd,{offset:s})},t.handleAdError=function(e,t,i){var s=this;this.options.debug&&console.error(e);var n=this.getAdErrorEventObject(e,t);this.player&&0===this.player.getPosition()&&(this._qoe.tick("adError"),n.timeLoading=this._qoe.between("adBeforePlay","adError")),this.trigger(d,n),this.destroyed()||(900===e.getErrorCode()||i?(clearTimeout(this.timeoutAdStart),this.timeoutAdStart=setTimeout((function(){return s.destroy()}),0)):this.destroy())},t.isVpaidAd=function(e){var t=e.getContentType();return"application/javascript"===t||"application/x-shockwave-flash"===t},t.destroy=function(){this.debugConsoleLog("[JW DEBUG] JW Player destroy AdsPlayer"),this.trigger("stopBlocking",{isDestroyed:!0}),this.off(),this.destroyed()||(this.player.off(null,null,this),clearTimeout(this.timeoutAdStart),clearInterval(this.progressIntervalId),this.currentAd=null,this.options=null,this.adsLoaderManager.reset(null,!0),this.view.adTakeDown(),this.video=null,this.initAdsManagerPromise=null,this.instreamProvider.off(),this.instreamProvider.setProxy(null),this.instreamProvider=null,this.view=null,this.player=null)},t.destroyed=function(){return!this.player},e}(),We=function(e){var t,l;function d(t,s,n,r,a,o,l,d,u,h){var c;return c=e.call(this,t,s,n,r,h)||this,t.utils.extend(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(c),t.Events),c.client=i,c.config=r,c.options=a,c.player=t,c.env=t.getEnvironment(),c.utils=t.utils,c.adsLoaderManager=d,c.view=l,c.qoe=new t.utils.Timer,c.instreamProvider=o,c.vmapPromise=Promise.resolve(),c.fullscreenIcon=t.getContainer().querySelector(".jw-icon-fullscreen"),c.video=u,c.hasPreroll=!0,c.reason=null,c}l=e,(t=d).prototype=Object.create(l.prototype),t.prototype.constructor=t,xe(t,l);var u=d.prototype;return u.checkPreroll=function(t){this.adsLoaderManager.initializeDisplay({restrict:!0}),this.reason=t&&t.playReason?t.playReason:p,e.prototype.checkPreroll.call(this,t)},u.checkPostrolls=function(t){this.schedule.isVMAP()&&this.adsPlayer?this.adsPlayer.beforeComplete():e.prototype.checkPostrolls.call(this,t)},u.createAdsPlayer=function(e){var t=this;this.adsPlayer&&!this.adsPlayer.destroyed()||(this.adsPlayer=new Qe(this,this.reason),this.adsPlayer.on("all",(function(i,s){return"allAdsComplete"===i?(t.adsPlayer.destroy(),void(t.adsPlayer=null)):"stopBlocking"===i?(t.stopBlocking(s&&s.isNonlinear),void(!e&&s&&s.isDestroyed&&(t.adsPlayer=null))):void("adError"!==i?(t.dequeueAdEvents(),t.trigger(i,s)):t.enqueueAdEvent(i,s,{preload:e}))})))},u.initAdsPlayer=function(e,t,i){var n=this;return e===s&&(this.reason=p),this.createAdsPlayer(i._preload),this.player.on("resize",(function(){return n.adsPlayer.resize()}),this.adsPlayer).on("fullscreen",(function(){return n.adsPlayer.resize()}),this.adsPlayer),this.adsPlayer.init(e,t,i).then((function(e){n.trigger("adsManager",{adsManager:e,videoElement:n.video})}))},u.adLoadRequest=function(e,t){var i=this,r=this.utils.extend({},this.config);r.ad=e,this.offset=e.offset||this.offset,r.adPosition=He(this.player);var a=new Re(r,this.utils),o=t?n:s,l=this.initAdsPlayer(o,a,e);return Te().then((function(){return i.adsPlayer.requestAds(),l}))},u.dequeueAdEvents=function(){var e=this;this._events.forEach((function(t){var i=t.type,s=t.event;e.trigger(i,s)})),this._events.splice(0)},u.triggerAdBreakEvents=function(e,t){var i=this;e._position=e._position||t,this.blockingInstreamPlayer.once("destroyed",(function(){i.dequeueAdEvents(),i.trigger("adBreakEnd",Ve(i,null,e))}));var s=Ve(this,null,e);this.trigger("adBreakStart",s),this.dequeueAdEvents(),this.adsPlayer&&this.adsPlayer.destroyed()&&this.stopBlocking()},u.exitFullscreenOnInlineIOS=function(){if(this.env.OS.iOS&&!(this.env.Browser.version.major<10)){var e=this.player.getContainer();e.requestFullscreen||e.webkitRequestFullscreen||(this.player.setFullscreen(!1),this.utils.style(this.fullscreenIcon,{display:"none"}))}},u.startBlocking=function(e){if(!this.blockingInstreamPlayer&&!this.destroyed()){this.exitFullscreenOnInlineIOS(),this.qoe.tick("adLoading"),this.utils.addClass(this.player.getContainer(),r),this.blockingInstreamPlayer=this.player.createInstream().init();var t=e?"":this.options.loadingAd;this.blockingInstreamPlayer.setText(t),this.blockingInstreamPlayer.applyProviderListeners(this.instreamProvider),this.adsPlayer&&!this.adsPlayer.destroyed()&&(this.adsPlayer.blockingInstreamPlayer=this.blockingInstreamPlayer),this.view.adSetup()}},u.stopBlocking=function(e){this.destroyed()||(this.player.off("viewable",null,this),this.utils.style(this.fullscreenIcon,{display:""}),this.utils.removeClass(this.player.getContainer(),[a,o,r]),this.blockingInstreamPlayer&&(this.instreamProvider.off(),this.blockingInstreamPlayer.destroy(),this.blockingInstreamPlayer=null),e||this.view.adTakeDown())},u.loadAd=function(e,t){if(e)return this.adsPlayer&&this.adsPlayer.scheduledAd!==e&&this.adsPlayer.destroy(),e._preload=!0,this.adLoadRequest(e,t)},u.playPreloadedPromise=function(e){var t=this;e.then((function(){return t.adsPlayer.startAdsLoader(t.blockingInstreamPlayer)})).catch((function(){t.stopBlocking()}))},u.startAdBreak=function(e,t){var i=this;e&&(this.adsPlayer&&this.adsPlayer.scheduledAd!==e&&this.adsPlayer.destroy(),this.startBlocking(),this.dequeueAdEvents(),this.adLoadRequest(e,t).then((function(){i.adsPlayer.startAdsLoader(i.blockingInstreamPlayer)})).catch((function(){i.stopBlocking()})))},u.destroy=function(){this.stopBlocking();var t=this.adsLoaderManager;t&&(t.reset(),this.adsLoaderManager=null),this.adsPlayer&&this.adsPlayer.destroy(),this.adsPlayer=null,e.prototype.destroy.call(this)},u.destroyed=function(){return null===this.adsLoaderManager},d}(De),Ge=function(){function e(e,t){this.adsLoader=null,this.adDisplayContainer=null,this.displayInitialized=!1,this.initialized=!1,this.started=!1,this.adsRequest=null,this.userRequestContext=null,this.adsManager=null,this.adsLoaderEvents={},this.adsManagerEvents={},this.container=t,this.schedule=null,this.breakMap={},this.player=e,this.environment=e.getEnvironment()}var t=e.prototype;return t.getVpaidMode=function(e){var t=google.ima.ImaSdkSettings.VpaidMode;return"disabled"===e||"none"===e?t.DISABLED:"enabled"===e?t.ENABLED:t.INSECURE},t.initializeDisplay=function(e){this.adDisplayContainer&&!this.displayInitialized&&(this.adDisplayContainer.initialize(),e&&e.restrict&&(this.displayInitialized=!0))},t.contentComplete=function(){this.adsLoader&&this.adsLoader.contentComplete()},t.reset=function(e,t){var i=this;if(t){this.adsRequest=null,this.userRequestContext=null;var s=this.adsManager;s&&(s.destroy(),this.adsManager=null),this.adsManagerEvents={},Object.keys(this.adsLoaderEvents).forEach((function(e){i.adsLoader.removeEventListener(e,i.adsLoaderEvents[e])})),this.adsLoaderEvents={}}else this.contentComplete();e&&(this.schedule=null,this.breakMap={}),this.initialized=this.started=!1},t.prepare=function(e,t){var i=google.ima.settings;i.setDisableCustomPlaybackForIOS10Plus(!0);var s=t.locale||this.player.getConfig().language;i.setLocale(s);var n=t.ppid;return n&&i.setPpid(n),"enabled"===t.omidSupport&&i.setFeatureFlags({enableOmidBeta:!0}),t.maxRedirects>=0&&i.setNumRedirects(t.maxRedirects),null===this.adsLoader&&(this.adDisplayContainer=new google.ima.AdDisplayContainer(this.container,e),this.adsLoader=new google.ima.AdsLoader(this.adDisplayContainer)),this.adsLoader},t.open=function(e,t,i){var s=this,n=this.prepare(i,t);return new Promise((function(e,t){n.addEventListener(google.ima.AdErrorEvent.Type.AD_ERROR,t,!1),n.addEventListener(google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,e,!1),s.adsLoaderEvents[google.ima.AdErrorEvent.Type.AD_ERROR]=t,s.adsLoaderEvents[google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED]=e}))},t.requestAds=function(e,t,i,s){if(null===this.adsRequest&&s){var n=this.player,r=this.adsRequest=new google.ima.AdsRequest,a=this.userRequestContext={requestType:e,vpaidMode:t.vpaidmode,playerVersion:n.version.split("+")[0],adPosition:t.adPosition};r.setAdWillAutoPlay(!1!==n.getConfig().autostart),r.setAdWillPlayMuted(n.getMute());var o=n.getSafeRegion(!1);r.linearAdSlotWidth=o.width,r.linearAdSlotHeight=o.height;var l=n.getSafeRegion(!0);r.nonLinearAdSlotWidth=l.width,r.nonLinearAdSlotHeight=l.height,r.forceNonLinearFullSlot=i.forceNonLinearFullSlot,r.vastLoadTimeout=i.vastLoadTimeout,"enabled"===t.omidSupport&&(r.omidAccessModeRules=t.omidAccessModeRules);var d,u,h,c,p=this.adsLoader.getSettings(),g=this.getVpaidMode(a.vpaidMode);if(p.setPlayerType("jwplayer"),p.setPlayerVersion(a.playerVersion),p.setVpaidMode(g),s._pod)r.adsResponse=a.adsResponse=(d=s._pod,u=s._offSet,h=document.implementation.createDocument("http://www.iab.net/videosuite/vmap","vmap:VMAP",null),(c=h.documentElement).setAttribute("version","1.0"),d.forEach((function(e){var t=h.createElement("vmap:AdTagURI");t.appendChild(h.createCDATASection(e));var i=c.appendChild(h.createElement("vmap:AdBreak")),s=(""+u).replace("pre","start").replace("post","end");i.setAttribute("timeOffset",s);var n=i.appendChild(h.createElement("vmap:AdSource"));n.setAttribute("allowMultipleAds","true"),n.setAttribute("followRedirects","true"),n.appendChild(t)})),c.outerHTML||(new XMLSerializer).serializeToString(c));else if(s.adm||s._adXML)r.adsResponse=a.adsResponse=s.adm||s._adXML;else if(s.tag||s._adQueue&&1===s._adQueue.length){var m=s.tag||s._adQueue[0];r.adTagUrl=a.adTagUrl=m.trim()}else{var f=s._adQueue&&s._adQueue.length?function(e){var t=document.implementation.createDocument("http://www.w3.org/2001/XMLSchema-instance","VAST",null),i=t.documentElement;return i.setAttribute("version","2.0"),e.forEach((function(e,s){var n=t.createElement("Ad");n.setAttribute("id",s);var r=t.createElement("Wrapper"),a=t.createElement("Extensions"),o=t.createElement("Extension");o.setAttribute("type","waterfall"),o.setAttribute("fallback_index",s);var l=t.createElement("VASTAdTagURI");l.appendChild(t.createCDATASection(e)),n.appendChild(r),r.appendChild(l),r.appendChild(a),a.appendChild(o),i.appendChild(n)})),i.outerHTML||(new XMLSerializer).serializeToString(i)}(s._adQueue):s.xml;r.adsResponse=a.adsResponse=f}this.adsLoader.requestAds(r,a)}},t.getAdsManager=function(e,t,i){var s=new google.ima.AdsRenderingSettings;s.enablePreloading=i.enablePreloading||i.preloadAds,s.loadVideoTimeout=i.loadVideoTimeout,s.uiElements=null,s.useStyledNonLinearAds=!0,this.environment.OS.android&&this.environment.Browser.chrome&&this.environment.Browser.version.major>=84&&(s.mimeTypes=["video/mp4","video/webm"]);var n=this.player.getConfig().bandwidthEstimate;(s.bitrate=n?n/1e3:-1,i.customUi)&&(i.customUi.disableUi&&(s.disableUi=!0));return this.adsManager=e.getAdsManager(t,s),this.userRequestContext=e.getUserRequestContext(),this.adsManager},t.init=function(e,t,i){null!==this.adsManager&&!1===this.initialized&&(this.adsManager.init(e,t,i),this.initialized=!0)},t.start=function(){null!==this.adsManager&&!1===this.started&&(this.initializeDisplay({restrict:!0}),this.adsManager.start(),this.started=!0)},t.bindEvents=function(e){var t=this,i=google.ima.AdEvent.Type,s=google.ima.AdErrorEvent.Type;Object.keys(e).forEach((function(n){var r=i[n]||s[n],a=t.adsManagerEvents[r];a&&t.adsManager.removeEventListener(r,a),t.adsManager.addEventListener(r,e[n],!1),t.adsManagerEvents[r]=e[n]}))},t.unbindEvents=function(e){var t=this,i=google.ima.AdEvent.Type,s=google.ima.AdErrorEvent.Type;e.forEach((function(e){var n=i[e]||s[e],r=t.adsManagerEvents[n];r&&(t.adsManager.removeEventListener(n,r),delete t.adsManagerEvents[n])}))},t.getTag=function(e){if("string"==typeof this.schedule)return this.schedule;var t=Ue(e,"getAdPodInfo");if(t){var i=this.breakMap[Ue(t,"getTimeOffset")]||{};if(i.tag)return i.tag}return this.userRequestContext?this.userRequestContext.adTagUrl||this.userRequestContext.adsResponse||"":(console.error("invalid request context",this.userRequestContext),"")},t.getJwpSeg=function(e){var t=Ue(e,"getAdPodInfo");if(t){var i=Ue(t,"getTimeOffset");return this.breakMap[i]&&this.breakMap[i].jwpseg}return null},t.getTimeoffsetFromPosition_=function(){var e,t=this.player.getPosition(),i=1/0;return Object.keys(this.breakMap).forEach((function(s){var n=t-s;n>=0&&n<i&&(e=s,i=n)})),i===1/0?-1:e},t.skipAd=function(){this.adsManager&&this.adsManager.skip()},t.getBid=function(e){var t=qe(e,this.player.utils);return this.breakMap[t]?this.breakMap[t].bid:null},t.setBid=function(e,t){var i=qe(e,this.player.utils);this.breakMap[i]=this.breakMap[i]||{},this.breakMap[i].bid=t},e}(),Je={},Xe={},Fe={},$e=function(e,t){var i=Je[t];return i||(Je[t]=new Promise((function(i,s){var n=new e.key(t);if("unlimited"===n.edition())return s();var r=["//","entitlements.jwplayer.com","/",n.token(),".json"];"file:"===window.location.protocol&&r.unshift("https:"),e.ajax(r.join(""),(function(e){var t=e&&e.response;t?i(t):s()}),(function(){s()}),{timeout:1e4,responseType:"json"})})))},Ke=function(e,t){var i=Xe[t];return i||(Xe[t]=$e(e,t).catch((function(){return{}})).then((function(e){if(!1===e.canUseVPB)throw new Error("Not entitled for Player Bidding")})))},Ye=function(e,t,i){var s=Fe[t];return s||(Fe[t]=$e(e,t).catch((function(){return{}})).then((function(e){var t,s;if(!0===i.outstream?(t=!1!==e.canPlayOutstreamAds,s="Outstream Ad Limit Reached"):(t=!1!==e.canPlayAds,s="Ad Limit Reached"),!1===t)throw new Error(s);return{message:"Can Play Ads"}})))},Ze=function(){};var et="8.10.0",tt=function(){function e(e,t,s,n){this.player=e,this.player.utils.extend(this,this.player.Events),this.pluginConfig=t,this.div=s,this.configScheduleParser=new Me(this.player,this.pluginConfig,i),this.options=new Re(this.pluginConfig||{},this.player.utils),this.adRules=this.configScheduleParser.getAdRules(),this.videoElement=null,this.playlistItemEventCount=0,this.nextPlaylistItemManager=null,this.nextPlaylistRelated=!1,this.casting=!1,this.bidsBlock=this.pluginConfig.bids,n&&n.sdkPromise&&n.checkEntitlements?(n.checkEntitlements(),n.sdkPromise()):(!function(e,t,i,s){var n,r=t.key,a=e.utils,o=Ye(a,r,i);o.catch(Ze),i.bids&&(n=Ke(a,r)).catch(Ze),e.on("ready",(function(){n&&n.catch((function(i){e.trigger("destroyBidding"),e.trigger(M,be(i.message,60009,t,s))})),o.catch((function(i){e.trigger("destroyPlugin",i),e.trigger(M,be(i.message,60002,t,s))}))}))}(this.player,this.player.getConfig(),this.pluginConfig,i),Te(this.player.utils).catch(this.player.utils.noop)),this.view=new Se(this.div,this.player.id,this.player.utils),this.instreamProvider=new je(this.player.utils,this.player.Events,this.view),this.adsLoader=new Ge(this.player,this.view.getAdDiv()),this.playlistItemManager=null,this.version=et,this.player.pauseAd=this.pauseAd.bind(this),this.player.playAd=this.playAd.bind(this),this.player.skipAd=this.skipAd.bind(this),this.player.on("ready",this.onReadyCallback,this),this.player.on("playlistItem",this.onPlaylistItemCallback,this),this.player.on("playlistComplete",this.onPlaylistCompleteCallback,this),this.player.on("cast",this.onCastCallback,this),this.player.on("mute",this.onMuteCallback,this),this.player.on("destroyPlugin",this.onDestroyPlugin,this),this.player.on("destroyBidding",this.onDestroyBidding,this),this.player.on("remove",this.destroyPlugin,this)}var t=e.prototype;return t.adsDebugMode=function(){this.options.debug=!0,this.playlistItemManager&&(this.playlistItemManager.debugConsoleLog=function(){for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];console.log(t)})},t.getCompanions=function(e,t,i,s){try{return e.getCompanionAds(t,i,s)}catch(e){return[]}},t.addCompanionsToDOM=function(e){if(e&&e.length){var t=document.getElementById(this.options.companiondiv.id);if(t){var i=e[0];i&&("function"==typeof i.getContent?t.innerHTML=i.getContent():t.innerHTML=i.resource||i.content)}}},t.convertCompanions=function(e){for(var t=[],i=0;i<e.length;i++){var s=e[i];t.push({width:s.getWidth(),height:s.getHeight(),type:"html",resource:s.getContent()})}return t},t.manageCompanionAd=function(e){var t=e.currentAd,i=new google.ima.CompanionAdSelectionSettings;i.sizeCriteria=google.ima.CompanionAdSelectionSettings.SizeCriteria.IGNORE;var s=this.options.companiondiv||{width:300,height:250},n=this.convertCompanions(this.getCompanions(t,s.width,s.height,i)),r=n.length;if(r){var a=Ve(this.playlistItemManager,t,e.scheduledAd);a.companions=n,this.player.trigger("adCompanions",a)}if(this.options.companiondiv){i=new google.ima.CompanionAdSelectionSettings,this.options.companionResourceType&&(i.resourceType=google.ima.CompanionAdSelectionSettings.ResourceType[this.options.companionResourceType]);var o=this.getCompanions(t,this.options.companiondiv.width,this.options.companiondiv.height,i);r=Math.max(r,o.length),this.addCompanionsToDOM(o)}return r>0},t.destroyPlugin=function(){this.destroy(),this.adsLoader&&this.adsLoader.adDisplayContainer&&this.adsLoader.adDisplayContainer.destroy(),this.player.off(null,null,this),this.player.playAd=this.player.utils.noop,this.player.pauseAd=this.player.utils.noop},t.resetSchedule=function(e){this.playlistItemManager&&this.playlistItemManager.adsPlayer&&this.playlistItemManager.adsPlayer.discardAdBreak(),this.adsLoader.contentComplete(),this.destroy(e),function(e){var t=e.getCues();if(Array.isArray(t)&&t.length){var i=t.filter((function(e){return"ads"!==e.cueType}));e.setCues(i)}}(this.player)},t.createPlaylistItemManager=function(e,t,i,s){var r=this,a=e.item||{},o=this.configScheduleParser.getSchedule(a,i.playlistItemEventCount),l=new(s&&s.PlaylistItemManager?s.PlaylistItemManager:We)(this.player,o,a,this.pluginConfig,this.options,this.instreamProvider,this.view,this.adsLoader,this.videoElement,this.casting);return l.on("all",(function(e,t){if("preloadNext"!==e)r.player.trigger(e,t);else{var s=y({},i,{preloadPreroll:!0,playlistItemEventCount:r.playlistItemEventCount+1});l.next=r.createPlaylistItemManager(t,n,s)}})),l.init(this.bidsBlock,i),l.on(h,(function(){return r.manageCompanionAd(l.adsPlayer)})),l},t.handlePlaylistItem=function(e,t,i,s){var r=this;s&&s.sdkPromise?s.sdkPromise():Te(this.player.utils).then((function(){r.adsLoader.prepare(r.videoElement,i)}));var a=e.item||this.player.getPlaylistItem(e.index);this.resetSchedule(!0);var o=this.configScheduleParser.getSchedule(a,this.playlistItemEventCount);!(t===n&&!this.adRules.rulesAllowAdPlayback(this.playlistItemEventCount))&&o&&(o.getAllAds().length||o.isVMAP())&&(this.nextPlaylistItemManager&&a!==this.nextPlaylistItemManager.item&&!1===this.nextPlaylistRelated&&(this.nextPlaylistItemManager.off(null,null,this),this.nextPlaylistItemManager.destroy(),this.nextPlaylistItemManager=null),this.adsLoader.reset(!0),this.playlistItemManager=this.nextPlaylistItemManager||this.createPlaylistItemManager(e,t,i),this.playlistItemManager.attachListeners(),this.nextPlaylistItemManager=null,this.nextPlaylistRelated=!1)},t.pauseAd=function(e,t){this.playlistItemManager&&this.playlistItemManager.adsPlayer&&(e?this.playlistItemManager.adsPlayer.pause(t||{}):this.playlistItemManager.adsPlayer.resume(t||{}))},t.playAd=function(e,t){var i,n=this.player.utils.extend({},this.pluginConfig);i=this.player._.isArray(e)?e.slice(0):[e];var r=new(t&&t.Options?t.Options:Re)(n,this.player.utils);r.setLocalizationOptions(this.player.getConfig().localization.advertising);var a=this.playlistItemManager?this.playlistItemManager.blockingInstreamPlayer:null;a&&(a.noResume=!0),this.destroy(),this.playlistItemManager=this.createPlaylistItemManager({item:this.player.getPlaylistItem()},s,r),this.playlistItemManager&&!this.playlistItemManager.destroyed()&&this.playlistItemManager.startAdBreak({_adQueue:i,_position:He(this.player),adBreakId:this.player.utils.genId(12)})},t.skipAd=function(){this.adsLoader&&this.adsLoader.skipAd()},t.onReadyCallback=function(e){var t=this;this.options.setLocalizationOptions(this.player.getConfig().localization.advertising),this.videoElement||(this.videoElement=this.player.createInstream().getMediaElement()),e&&e.sdkPromise?e.sdkPromise():Te(this.player.utils).catch((function(e){e.message.match(/Failed to load/)&&t.handleDependencyError("Ad playback blocked by an ad blocker",2e4)}));var i=document.body;this.primeAdDisplay=function(){i.removeEventListener("mouseup",t.primeAdDisplay),i.removeEventListener("touchend",t.primeAdDisplay),t.adsLoader.initializeDisplay(),t.primeAdDisplay=null},i.addEventListener("mouseup",this.primeAdDisplay,!1),i.addEventListener("touchend",this.primeAdDisplay,!1)},t.onPlaylistItemCallback=function(e){this.playlistItemEventCount++;var t=y({playlistItemEventCount:this.playlistItemEventCount},this.options);this.handlePlaylistItem(e,n,t),this.playlistItemManager&&!this.playlistItemManager.schedule.isVMAP()&&this.sendCues(this.playlistItemManager.schedule)},t.onPlaylistCompleteCallback=function(){this.resetSchedule(!0)},t.onCastCallback=function(e){this.casting=Boolean(e.active),e.active&&this.resetSchedule()},t.onMuteCallback=function(e){this.instreamProvider.mute(e)},t.onDestroyPlugin=function(){this.destroy()},t.onDestroyBidding=function(){this.bidsBlock=null},t.sendCues=function(e){var t=this,i=e.getMidRolls(),s=[];i.length&&i.forEach((function(e){"nonlinear"!==e._type&&s.push({begin:e._offSet,text:t.options.cuetext,cueType:"ads"})})),this.player.addCues(s)},t.destroy=function(e){this.playlistItemManager&&(e&&(this.nextPlaylistItemManager=this.playlistItemManager.next,this.nextPlaylistRelated=this.playlistItemManager.nextPlaylistRelated),this.playlistItemManager.off(null,null,this),this.playlistItemManager.destroy(),this.playlistItemManager=null),this.primeAdDisplay&&(document.body.removeEventListener("mouseup",this.primeAdDisplay),document.body.removeEventListener("touchend",this.primeAdDisplay)),this.configScheduleParser.reset()},t.handleDependencyError=function(e,t){this.destroyPlugin(),this.player.trigger(d,Ne(null,{message:e,adErrorCode:t,id:"-1",placement:Oe(this.player.getConfig()),tag:""}))},e}();!function(e){if(e&&"undefined"!=typeof window){var t=document.createElement("style");t.setAttribute("media","screen"),t.innerHTML=e,document.head.appendChild(t)}}(".jw-plugin-googima{overflow:hidden;width:100%;height:100%;display:block;visibility:hidden;pointer-events:none;opacity:0}.jw-plugin-googima.jw-ad-instream{visibility:visible;display:block;pointer-events:all;opacity:1}.jw-plugin-googima.jw-ad-instream .jw-ads-view>:not(div),.jw-plugin-googima.jw-ad-instream .jw-ads-view>div:not(:empty){width:100%;height:100%}.jw-plugin-googima.jw-ad-linear{top:0;left:0;bottom:0}.jw-plugin-googima.jw-ad-non-linear{top:auto}.jw-plugin-googima .jw-ads-view{position:absolute;width:100%;height:100%}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-controlbar{font-size:1em}.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display,.jwplayer.jw-flag-ads-googleima.jw-flag-touch .jw-display-icon-display .jw-icon-display{pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar{background:0 0!important;pointer-events:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-horizontal-volume-container{pointer-events:auto}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon{pointer-events:all}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-icon-fullscreen:not(.jw-fullscreen-ima){display:none}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-fullscreen-ima{display:flex}.jwplayer.jw-flag-ads-googleima .jw-controls-backdrop{display:none}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:rgba(0,0,0,.25);border-radius:3px}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0 10px}@supports (filter:drop-shadow(0 0 3px #000)){.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume,.jwplayer.jw-flag-ads-googleima.jw-ie .jw-svg-icon{background:0 0;border-radius:0}.jwplayer.jw-flag-ads-googleima.jw-ie .jw-slider-volume{margin:0}}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-svg-icon{fill:#fff;filter:drop-shadow(0 0 3px #000)}.jwplayer.jw-flag-ads-googleima .jw-controlbar .jw-text{text-shadow:0 0 3px #000}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player.jw-flag-ads.jw-state-playing.jw-flag-touch:not(.jw-flag-ads-vpaid) .jw-controls .jw-controlbar{pointer-events:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar{flex-flow:column-reverse nowrap;height:100%;max-height:none}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-button-container{align-items:flex-end;flex-wrap:wrap;margin-bottom:7px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-controlbar .jw-icon{height:30px}.jwplayer.jw-flag-ads-googleima.jw-flag-small-player .jw-text{align-self:flex-start;margin:16px 0 0 16px;order:-1;width:100%}"),(window.jwplayerPluginJsonp||window.jwplayer().registerPlugin)(i,"8.1",tt)}();
